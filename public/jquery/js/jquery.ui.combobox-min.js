(function(e){var f=38,j=40,i=13,d=27,k=115,h=32;var a=/[9XEATxea]/;e.widget("ui.combobox",{init:function(){var o=this;var n=this.applySetting(this.options,this.element);this.options.canLookup=n.canLookup;this.options.beforeLookup=n.beforeLookup;this.options.afterLookup=n.afterLookup;this.options.change=n.change;this.options.select=n.select;this.options.dialog=n.dialog;this.options.styles=n.styles;this.options.afterShow=n.afterShow;this.options.dynamicTag=n.dynamicTag;this.element.attr("readonly",n.readOnly);this.element.data("offset",this.element.offset());this.element.data("position",this.element.position());this.element.data("width",this.element.width());this.element.data("height",this.element.height());this.wraperbox=e("<span class='fsx_combo_box'></span>");function q(){o.hideList();e(document).unbind("click",q)}if(n.button){this.arrowElem=e(n.arrowHTML.call(this)).click(function(s){if(o.element.is(":disabled")){return false}if(o.element.is("[readonly]")){var r=o.element.attr("editable");if(!("true"==r)){return false}}if(!o.options.canLookup){return false}if(!o.options.beforeLookup(o)){return false}if(o.isListVisible()){}else{o.showList();e(document).click(q)}return false});var l=e('<div class="input-group"></div>');this.element.wrap(l);this.element.after(this.arrowElem)}if(n.dialog){var p="fsccommboo"+Math.random();var m=e('<input type="text" id="'+p+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>');e("body").append(m);this.listElem=this.buildList().insertAfter(m).hide()}else{this.listElem=this.buildList().insertAfter(this.element.parent()).hide()}if(n.autoShow){this.element.focus(b(this,"showList")).blur(function(r){o.finishSelection(o.selectedIndex,r);o.hideList()})}},_setOption:function(l,m){this.options[l]=m;if(l=="readOnly"){this.element.attr("readOnly",m)}},_init:function(){this.init.apply(this,arguments)},applySetting:function(o,n){var l=n.attr("id");var p=e('<i class="fa fa-list-alt" aria-hidden="true"></i>');this.fs_alink=e('<A href="javascript:void(0);" tabIndex="-1"  ID="LK'+l+'" class="jrivaly lookup-link-class ui-combobox-link-class input-group-addon input-group-append input-group-text"></A>').bind("ondeactivate",function(){fs_rival_deactivate(l,this)}).bind("onbeforedeactivate",function(){fs_rival_beforedeactivate(l,this)});var m=jQuery.extend({data:[],dataMap:{},picture:"",xmldocs:null,singleShow:false,autoShow:false,matchMiddle:true,readOnly:false,canLookup:true,button:true,styles:null,viewStyle:null,beforeLookup:function(){return true},afterLookup:function(r,q){return true},change:function(r,q){},select:function(r,q){},key:function(r,q){},arrowURL:"drop_down.png",arrowHTML:function(){return e(this.fs_alink).append(p)},onSelect:function(q,r){},afterShow:function(){},listContainerTag:"div",listHTML:c},o);if(n.is("[readonly]")){m.readOnly=true}return m},composeLookupDatas:function(q){var w=[];var t=this.options.xmldocs;if(t){var o=e(t).children();if(o.length>0){try{var l=t.documentElement;if(!l){l=t.parentNode}var n=l.getAttribute("type");if(n&&((n=="error")||(n=="none"))){return w}}catch(p){}if(o.children().length==0){return w}var r;var u="element";var s;var v=this.options.dynamicTag;if(v){r=e(v,t).get(0)}else{r=o.children()[0];if(t.parentNode){r=o[0]}v=r.nodeName}if(r){var m=e(r).children();if(m.length>0){u=m[0].nodeName;if(m.length>1){s=m[1].nodeName}}}e(v,t).each(function(z,A){var y=e(u,this).text();w.push(y);if(s){var x=e(s,this).text();q[y]=x}else{q[y]=y}})}}return w},cleanup:function(){if(this.boundKeyHandler){e(document).unbind("keyup",this.boundKeyHandler)}if(this.arrowElem){this.arrowElem.remove()}this.listElem.remove()},destroy:function(){},setData:function(m,n){this.options[m]=n;if(m=="disabled"&&this.isListVisible()){this.hideList()}if(m=="data"||m=="xmldocs"||m=="listContainerTag"||m=="listHTML"){var l=this.isListVisible();this.listElem=this.buildList().replaceAll(this.listElem);this[l?"showList":"hideList"]()}},buildTableList:function(){var o=this;var m=this.applySetting(this.options,this.element);var l=m.listContainerTag;var n=e("<"+l+' style="z-Index:1999999;" class = "jrivaly ui-combobox-list"></'+l+">");n.hover(function(){},function(){if(n.is(":visible")){o.hideList()}});return n},buildNormalList:function(){var o=this;var m=this.applySetting(this.options,this.element);var l=m.listContainerTag;var n=e("<"+l+' style="z-Index:1999999;" class = "jrivaly ui-combobox-list"></'+l+">");m.dataMap={};this.options.dataMap={};if(!e.isArray(m.data)){m.dataMap=m.data;this.options.data=[];m.data=[];for(var q in m.dataMap){this.options.data.push(q);m.data.push(q)}}this.options.dataMap=m.dataMap;if(this.options.xmldocs){this.options.data=this.composeLookupDatas(this.options.dataMap);m.data=this.options.data}e.each(m.data,function(p,r){e(m.listHTML(r,p,m.singleShow,m.dataMap,m.viewStyle)).appendTo(n).click(b(o,"finishSelection",p)).mouseover(b(o,"changeSelection",p))});n.hover(function(){},function(){if(n.is(":visible")){o.hideList()}});return n},buildList:function(){if(this.listElem){this.listElem.empty()}return this.buildNormalList()},isListVisible:function(){return this.listElem.is(":visible")},showList:function(l){if(this.options.disabled){return}this.showNormalList(l)},showNormalList:function(q){if(!e.isArray(this.options.data)){this.options.dataMap=this.options.data;this.options.data=[];for(var l in this.options.dataMap){this.options.data.push(l)}}var v,w,m,s;try{v=this.element.offset();w=this.element.position();m=this.element.height();s=this.element.width()}catch(r){}if(v&&v.top&&v.left){}else{v=this.element.data("offset");w=this.element.data("position");m=this.element.data("height");s=this.element.data("width")}if(this.options.xmldocs){}if(!this.options.data){return}var o=this.options.data.length;w.top+=m+7;if(this.options.dialog){w.top=m;w.top=v.top+w.top;w.left=v.left}w.width=s+5;w.position="absolute";w.overflow="auto";if(o>15){w.height=200;w.width=s+20}var u=e(document.body);var n=u.innerHeight();var t=w.top+w.height;if(t>n){w.top=w.top-w.height-m-7}if(this.options.styles){w.width=this.options.styles.width}this.boundKeyHandler=b(this,"keyHandler");e(document).keyup(this.boundKeyHandler);e(".ui-combobox-list").hide();this.listElem.css(w).show();this.changeSelection(this.findSelection(),q);if(this.options.afterShow){this.options.afterShow()}},showTableList:function(l){},hideList:function(){this.listElem.hide();e(document).unbind("keyup",this.boundKeyHandler)},closeList:function(){hideList();if(this.arrowElem){this.arrowElem.remove()}this.listElem.remove()},keyHandler:function(n){if(this.options.disabled){return}var m=this.options.data.length;switch(n.which){case d:this.hideList();break;case f:var l=this.selectedIndex-1;if(l<0){l=m-1}this.changeSelection(l,n);break;case j:this.changeSelection((this.selectedIndex+1)%m,n);break;case h:case i:this.finishSelection(this.selectedIndex,n);break;default:this.fireEvent("key",n);this.changeSelection(this.findSelection());break}},prepareCallbackObj:function(m){m=m||this.element.val();var l=e.inArray(m,this.options.data);return{value:m,index:l,isCustom:l==-1,inputElement:this.element,listElement:this.listElement}},fireEvent:function(l,n,o){var m=this.options[l];if(m){m(n,this.prepareCallbackObj(o))}},findSelection:function(){var o=this.options.data;var p=this.element.val().toLowerCase();if(o&&o.length>0){for(var n=0,l=o.length;n<l;++n){var m=o[n].toLowerCase().indexOf(p);if(m==0){return n}}if(this.options.matchMiddle){for(var n=0,l=o.length;n<l;++n){var m=o[n].toLowerCase().indexOf(p);if(m!=-1){return n}}}}return 0},changeSelection:function(l,m){this.selectedIndex=l;this.listElem.children(".selected").removeClass("selected");this.listElem.children(":eq("+l+")").addClass("selected");if(m){this.fireEvent("change",m,this.options.data[l])}},finishSelection:function(l,o){var n=this.options.data[l];this.element.val(n);this.hideList();this.fireEvent("select",o,n);var m=this.options.afterLookup;if(m){m(n,this.options.dataMap[n]||n)}}});e.fn.combobox.defaults={data:[],dataMap:{},picture:"",xmldocs:null,singleShow:false,autoShow:false,matchMiddle:true,readOnly:false,canLookup:true,beforeLookup:function(){return true},afterLookup:function(m,l){return true},change:function(m,l){},select:function(m,l){},key:function(m,l){},arrowURL:"drop_down.png",arrowHTML:function(){},listContainerTag:"div",listHTML:c,button:true};var g=e.fn.combobox;e.fn.combobox=function(m){var n=e("#LK"+e(this).attr("id"));if(!n.is(".ui-combobox-link-class")){n.remove()}var l=g.apply(this,arguments);if(!(l instanceof e)){return l}return l};function c(q,o,l,n,p){var r=q;if(!l&&n[q]){r+=" - "+n[q]}if("D"==p){r=n[q]}var m=o%2?"odd":"even";return'<span class = "jrivaly ui-combobox-item '+m+'" style="white-space:nowrap; ">'+r+"</span>"}function b(n,m){var l=[].slice.call(arguments,2);return function(){n[m].apply(n,l.concat([].slice.call(arguments)))}}e.fn.lookup=function(o){var r=e(this);var t={dialogTitle:"Lookup Dialog",dialogWidth:530,dialogHeight:315,dialogURL:"../flexigrid/flexidialog.jsp?seed="+Math.random(),dialogFeatures:"scrollbars=no;center=yes;border=thin;help=no;status=no;resizable=yes;",afterLookup:function(y){if(y.cell){var x=y.cell;r.val(x[0]);try{e("#"+r.attr("id")+"desc").html(x[1])}catch(w){}}else{var z=e(y);if(z.size()==1){var x=z[0].cell;r.val(x[0]);try{e("#"+r.attr("id")+"desc").html(x[1])}catch(w){}}else{var p="";z.each(function(A,B){if(A>0){p=p+","}p=p+B.cell[0]});r.val(p)}}},defaultColumnModel:true,defaultSearchItems:true,singleSelect:true,title:"",method:"POST",dataType:"xml",usepager:false,autoload:true,customizeColumn:false,useRp:false,showTableToggleBtn:false,width:500,height:250};var l=e.extend({},t,o);if(l.title){l.height=l.height==t.height?200:l.height}if(l.sortOptions){l.width=l.width==t.width?560:l.width;l.dialogWidth=l.dialogWidth==t.dialogWidth?560:l.dialogWidth}if(l.defaultColumnModel){var u=l.dialogHeight==t.dialogHeight?285:l.dialogHeight;l=e.extend({columnModel:[{display:"Item",name:"item",width:150,sortable:false,align:"center"},{display:"Description",name:"description",width:200,sortable:false,align:"left"}]},l);l.dialogHeight=u}if(l.defaultSearchItems){var u=l.dialogHeight==t.dialogHeight?285:(l.dialogHeight==285?315:l.dialogHeight);l=e.extend({searchItems:[{display:"Item",name:"item",isdefault:true},{display:"Description",name:"description"}]},l);l.dialogHeight=u}l.query=r.val();l.selectedItems=r.val().split(",");if(l.url||l.xml){var v="fs_lookup_iframe_"+Math.round(new Date().getTime()/1000);var s=e("<iframe id='"+v+"' name='"+v+"' width='100%' height='100%' scrolling='no' frameBorder='0'></iframe>");var q=e("<div style='display:none; padding: 5px;'></div>");q.append(s);e("body").after(q);var n=q.dialog({autoOpen:false,modal:true,title:l.dialogTitle,width:l.dialogWidth,height:l.dialogHeight,open:function(x,y){var w=q.parent();var z=w.position();var p=(l.dialogHeight+10-w.height())/2;q.height(l.dialogHeight+10);w.css("top",z.top-p)},beforeClose:function(p,w){setTimeout(function(){try{q.remove()}catch(x){}},500)}});window.getShowLookupDialogArguments=function(){return l};window.closeLookupDialog=function(){try{n.dialog("close")}catch(p){}};window.afterShowLookupDialog=function(p){try{n.dialog("close")}catch(w){}try{l.afterLookup(p)}catch(w){}};var m=window.open(l.dialogURL,v);m.opener=self;n.dialog("open");n.parent().css("zIndex",5002);n.parent().next(".ui-widget-overlay").css("zIndex",5001)}}})(jQuery);